create a log in c:\logs\<processname>:
!mona config -set workingfolder c:\logs\%p

create a pattern with !mona:
!mona pc 6000

find the pattern:
!mona findmsp
!mona pattern_offset 0x7A46317A

find jmp ESP
!mona jmp -r ESP

finding bad chars:
!mona bytearray #create byte array
>bytearray.txt can be used to insert into PoC
>bytearray.bin can be compared with this to find bad chars.

!mona compare -f c:\logs\<processname>\bytearray.bin -a 0x01cea154 (address contained on ESP aka start address) if we dont set a start address the entire memory is searched.

we can rerun this again after removing bad characters eg nulls:
!mona bytearray -cpb \x00 
and run the command again:
!mona compare -f c:\logs\<processname>\bytearray.bin -a 0x01cea154

we do this over and over again to find all the bad characters

may need to add an instruction at the start of esp to decrement it atleast teh same size as the shellcode we are using (probably abit more is better) so that msf venom has space to decode it properly. this can be generated with metasm_shell.rb, if we have a problem with nulls we can do something like add esp, -240h instead of esp, 240h






